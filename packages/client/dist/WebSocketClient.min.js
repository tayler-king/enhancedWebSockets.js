!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.WebSocketClient=t():e.WebSocketClient=t()}(self,(function(){return(()=>{var e={742:e=>{var t=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"==typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},161:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function o(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function i(e,t,n,i,c){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new o(n,i||e,c),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,o=[];if(0===this._eventsCount)return o;for(n in e=this._events)t.call(e,n)&&o.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,c=new Array(i);o<i;o++)c[o]=n[o].fn;return c},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,o,i,c){var s=r?r+e:e;if(!this._events[s])return!1;var u,a,f=this._events[s],l=arguments.length;if(f.fn){switch(f.once&&this.removeListener(e,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,t),!0;case 3:return f.fn.call(f.context,t,n),!0;case 4:return f.fn.call(f.context,t,n,o),!0;case 5:return f.fn.call(f.context,t,n,o,i),!0;case 6:return f.fn.call(f.context,t,n,o,i,c),!0}for(a=1,u=new Array(l-1);a<l;a++)u[a-1]=arguments[a];f.fn.apply(f.context,u)}else{var p,h=f.length;for(a=0;a<h;a++)switch(f[a].once&&this.removeListener(e,f[a].fn,void 0,!0),l){case 1:f[a].fn.call(f[a].context);break;case 2:f[a].fn.call(f[a].context,t);break;case 3:f[a].fn.call(f[a].context,t,n);break;case 4:f[a].fn.call(f[a].context,t,n,o);break;default:if(!u)for(p=1,u=new Array(l-1);p<l;p++)u[p-1]=arguments[p];f[a].fn.apply(f[a].context,u)}}return!0},s.prototype.on=function(e,t,r){return i(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return i(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,o){var i=r?r+e:e;if(!this._events[i])return this;if(!t)return c(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||o&&!s.once||n&&s.context!==n||c(this,i);else{for(var u=0,a=[],f=s.length;u<f;u++)(s[u].fn!==t||o&&!s[u].once||n&&s[u].context!==n)&&a.push(s[u]);a.length?this._events[i]=1===a.length?a[0]:a:c(this,i)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&c(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s},731:(e,t,r)=>{var n;if("object"==typeof globalThis)n=globalThis;else try{n=r(742)}catch(e){}finally{if(n||"undefined"==typeof window||(n=window),!n)throw new Error("Could not determine global this")}var o=n.WebSocket||n.MozWebSocket,i=r(755);function c(e,t){return t?new o(e,t):new o(e)}o&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(c,e,{get:function(){return o[e]}})})),e.exports={w3cwebsocket:o?c:null,version:i}},755:(e,t,r)=>{e.exports=r(735).version},735:e=>{"use strict";e.exports={version:"1.0.34"}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n={};return(()=>{"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function t(t,r){return function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],c=!0,s=!1;try{for(r=r.call(e);!(c=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{c||null==r.return||r.return()}finally{if(s)throw o}}return i}}(t,r)||function(t,r){if(t){if("string"==typeof t)return e(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,r):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function u(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}function f(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var l=0;function p(e){return"__private_"+l+++"_"+e}var h=r(161),y=r.n(h),v=r(731);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var m=p("options"),w=p("reconnect"),O=p("hasForceClosed"),g=p("lastMessageID"),j=p("callbacks"),_=p("webSocket"),P=p("token"),x=p("url"),S=p("createConnection"),k=p("attemptReconnection"),E=p("onSocketMessage"),C=p("onSocketClose"),N=p("onSocketError"),I=p("onSocketOpen"),T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(h,e);var t,r,n,l,p=(n=h,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=a(n);if(l){var r=a(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return u(this,e)});function h(e,t,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),n=p.call(this),Object.defineProperty(c(n),I,{value:W}),Object.defineProperty(c(n),N,{value:M}),Object.defineProperty(c(n),C,{value:L}),Object.defineProperty(c(n),E,{value:D}),Object.defineProperty(c(n),k,{value:R}),Object.defineProperty(c(n),S,{value:A}),Object.defineProperty(c(n),m,{writable:!0,value:{__deprecatedEventStructure:!1,maxReconnectInterval:3e4,maxReconnectAttempts:0,reconnectInterval:1e3,timeoutInterval:2e3,reconnectDecay:1.5,reconnect:!1}}),Object.defineProperty(c(n),w,{writable:!0,value:{attemptNumber:0,timeout:!1}}),Object.defineProperty(c(n),O,{writable:!0,value:!1}),Object.defineProperty(c(n),g,{writable:!0,value:0}),Object.defineProperty(c(n),j,{writable:!0,value:new Map}),Object.defineProperty(c(n),_,{writable:!0,value:!1}),Object.defineProperty(c(n),P,{writable:!0,value:void 0}),Object.defineProperty(c(n),x,{writable:!0,value:void 0}),"object"===o(t)&&(r=t),r&&(f(c(n),m)[m]=d(d({},f(c(n),m)[m]),r)),f(c(n),P)[P]=t,f(c(n),x)[x]=e,f(c(n),S)[S](),n}return t=h,r=[{key:"readyState",get:function(){return f(this,_)[_].readyState}},{key:"bufferedAmount",get:function(){return f(this,_)[_].bufferedAmount}},{key:"url",get:function(){return f(this,_)[_].url}},{key:"close",value:function(){var e;return f(this,O)[O]=!0,(e=f(this,_)[_]).close.apply(e,arguments)}},{key:"send",value:function(e,t,r){if("function"==typeof t&&(r=t,t=void 0),r){var n=++f(this,g)[g];return f(this,j)[j].set(n,r),f(this,_)[_].send(n+JSON.stringify([e,t]))}f(this,_)[_].send(JSON.stringify([e,t]))}}],r&&i(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),h}(y());function A(){var e=this;f(this,_)[_]&&(f(this,_)[_].onmessage=void 0,f(this,_)[_].onclose=void 0,f(this,_)[_].onerror=void 0,f(this,_)[_].onopen=void 0),f(this,_)[_]=new v.w3cwebsocket(f(this,x)[x],f(this,P)[P]),f(this,_)[_].onmessage=function(){var t;return(t=f(e,E))[E].apply(t,arguments)},f(this,_)[_].onclose=function(){var t;return(t=f(e,C))[C].apply(t,arguments)},f(this,_)[_].onerror=function(){var t;return(t=f(e,N))[N].apply(t,arguments)},f(this,_)[_].onopen=function(){var t;return(t=f(e,I))[I].apply(t,arguments)}}function R(){var e=this,t=f(this,w)[w].attemptNumber,r=f(this,m)[m],n=r.maxReconnectInterval,o=r.maxReconnectAttempts,i=r.reconnectInterval,c=r.timeoutInterval,s=r.reconnectDecay;if(++t===o)return f(this,w)[w]={attemptNumber:0,timeout:!1};var u=Math.min(i*Math.pow(s,t),n);setTimeout((function(){f(e,S)[S](),f(e,w)[w].timeout=setTimeout((function(){f(e,_)[_].close()}),c)}),u),f(this,w)[w].attemptNumber=t}function D(e){var r=e.data;if(r.length){var n=function(e){var r=e.indexOf("[");if(r<0)throw new Error("Invalid message format");var n,o,i=r>0,c=+e.slice(0,r);try{var s=t(JSON.parse(e.slice(r)),2),u=s[0],a=s[1];n=u,o=a}catch(e){throw new Error("Invalid message structure")}if(i&&(Number.isNaN(c)||!Number.isInteger(c)||c<=0))throw new Error("Invalid message ID");if(!i&&("string"!=typeof n||n.length<1||n.length>64))throw new Error("Invalid event");return[c,n,o]}(r),o=t(n,3),i=o[0],c=o[1],s=o[2];if(i||!["open","close","error"].includes(c)){if(i){if(!f(this,j)[j].has(i))return;var u=f(this,j)[j].get(i);return f(this,m)[m].__deprecatedEventStructure?u({error:c,data:s}):u(c,s),f(this,j)[j].delete(i)}this.onmessage?this.onmessage(c,s):this.emit(c,s)}}}function L(e){if(clearTimeout(f(this,w)[w].timeout),f(this,j)[j].forEach((function(e){e("Socket closed")})),f(this,j)[j].clear(),f(this,g)[g]=0,!f(this,O)[O]&&f(this,m)[m].reconnect){if(f(this,w)[w].attemptNumber)return f(this,k)[k]();f(this,k)[k]()}f(this,O)[O]=!1,this.onclose?this.onclose(e):this.emit("close",e)}function M(e){this.onerror?this.onerror(e):this.emit("error",e)}function W(e){clearTimeout(f(this,w)[w].timeout),f(this,O)[O]=!1,f(this,w)[w]={attemptNumber:0,timeout:!1},this.onopen?this.onopen(e):this.emit("open",e)}"undefined"!=typeof window&&(window.WebSocketClient=T)})(),n.default})()}));